<h1>New Version</h1>


<form action='create' id='version_form'>

  <div class='container'>

    <div style='flex:1'>

      <p>
        Name: <input type='text' name='version_name'></input>
      </p>

      <p>
        Output Folder: <input type='text' name='version_output_folder'></input>
      </p>

        <p>
          <select name='version[design_template_id]' id='version_design_template_id' onchange='changeTemplate();'>
      <%=   @design_templates.each { |t| %>
              <option value='<%= t.id.to_s %>'><%= t.name %></option>
      <%    } %>
          </select>
        </p>`

    </div>

    <div id='values_container' style='flex:1'>
    </div>

  </div>

  <input name='prompt_data' id='prompt_data' style='hidden'></div>

  <button id='create' onclick='create_version();'>Create</button>

</form>

<script>


function create_version()
{
    var count = $('#count').val();
    var form = $('#version_form');
    var s, v, o;

    var oReturn;
    oReturn = {};

    var prompt;

    for( var i = 0; i < count; i++ )
    {
      s = '#val' + i;
      o = $(s);
      v = o.val();

      prompt = o.attr( 'data-prompt' );

      oReturn[ prompt ] = v;

    }

    $('#prompt_data').attr( 'value', JSON.stringify( oReturn ) );

    form.submit();
}

function changeTemplate()
{
  var template_id = $('#version_design_template_id').val();
  var uri = "http://localhost:3000/partials/values/" + template_id;

  $.get( uri, function(data, status)
    {
        $('#values_container').html( data );
    } );
}

</script>
