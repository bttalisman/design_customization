// This script should be run by Adobe Illustrator on a design file containing// placed images with unique names.//// This script extracts these image names and places them in a data file:// /output/<original name>_images.jsn.  Users can get these names and assign replacement images,// or other things, place this in: /output/<original name>/_data.jsn file.//// SearchAndReplaceImages.jsx is the script file// responsible for finding and replacing these images with other images.#include "~/design_customization/app/assets/javascripts/json2.jsx"#include "~/design_customization/app/assets/javascripts/include-for-ai.js"// work = true;app.userInteractionLevel = UserInteractionLevel.DONTDISPLAYALERTS;function existsInImagesArray( array, imageName ){  var bFound = false;  for( var i = 0; i < array.length; i++ )  {    if( array[i].name == imageName )    {      bFound = true;      break;    }  }  return bFound;}var itemsArray = [];if(documents.length > 0){  var placedItems = activeDocument.placedItems;  var originalFolder = activeDocument.fullName.path;  if(placedItems.length > 0)  {    for (var i = 0 ; i < placedItems.length; i++)    {      var item = placedItems[i];      var item_name = item.name;      var item_width = item.width;      var item_height = item.height;      var boundingBox = item.boundingBox      if( item_name != '' )      {        if( !existsInImagesArray( itemsArray, item_name ) )        {          o = {};          o.name = item_name;          o.width = boundingBox[2] - boundingBox[0];          o.height = boundingBox[1] - boundingBox[3];          itemsArray.push( o );        }      }    } // each text frame  } // if there are frames   var fileName = activeDocument.name;   fileName = fileName.slice(0, -3);   fileName = originalFolder + "/output/" + fileName + "_images.jsn";   var writeFile = File( fileName );   out = writeFile.open('w', undefined, undefined);   writeFile.encoding = "UTF-8";   writeFile.lineFeed = "Macintosh";//   alert( JSON.stringify( itemsArray ) );   writeFile.writeln( JSON.stringify( itemsArray ) );   writeFile.close();   activeDocument.close();} // if there are documents