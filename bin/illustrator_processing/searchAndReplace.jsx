#include "json2.jsx"var baseFileName = activeDocument.name;baseFileName = baseFileName.slice(0, -3);// Load the file containing prompts mapped to replacement text.var fileName = "Users/bent/customization/working/" + baseFileName + "_data.jsn";var read_file = File( fileName );read_file.open( 'r', undefined, undefined );var s = read_file.read();read_file.close();var data;data = JSON.parse( s );if(documents.length > 0){   var textRefs = activeDocument.textFrames;   if(textRefs.length > 0)   {      for (var i = 0 ; i < textRefs.length; i++)      {            var textLines = textRefs[i].lines;            if( textLines.length > 0 )            {                    for( var x = 0; x < textLines.length; x++ )                    {                        var l = textLines[ x ];                        if( l.contents.indexOf( "<%" ) > -1 )                        {                            var key = l.contents;                            var replaceText;                            key = key.replace( "<%", "" );                            key = key.replace( "%>", "" );                            replaceText = data[ key ];                            l.contents = replaceText;                        }                     } // each line            } // if there are lines      } // each text frame   } // if there are frames   // Export to JPG   fileName = baseFileName + "_mod.jpg";   fileName = "Users/bent/customization/working/" + fileName;   saveInFile = new File( fileName );   var options = new ExportOptionsJPEG();   options.antiAliasing = true;   options.artBoardClipping = true;   var guideLayer = app.activeDocument.layers.getByName("Design Guides");   guideLayer.visible = false;   activeDocument.exportFile( saveInFile, ExportType.JPEG, options );   // Save the modified AI file   fileName = baseFileName + "_mod.ai";   fileName = "Users/bent/customization/working/" + fileName;   saveInFile = new File( fileName );   activeDocument.saveAs( saveInFile );   activeDocument.close();} // if there are documents