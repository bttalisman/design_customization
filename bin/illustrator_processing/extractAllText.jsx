// This script should be run by Adobe Illustrator on a design file.//// This script extracts all strings places them in a data file:// /output/<original name>_all_strings.jsn, intended to be used by// unit tests verifying that tags have been correctly replaced.#include "~/design_customization/app/assets/javascripts/json2.jsx"var stringsArray = [];if(documents.length > 0){  var textRefs = activeDocument.textFrames;  var originalFolder = activeDocument.fullName.path;  if(textRefs.length > 0)  {    for (var i = 0 ; i < textRefs.length; i++)    {      var textLines = textRefs[i].lines;        if( textLines.length > 0 )        {            for( var x = 0; x < textLines.length; x++ )            {                var l = textLines[ x ];                var s = l.contents;                stringsArray.push( s );             } // each line        } // if there are lines    } // each text frame  } // if there are frames   var fileName = activeDocument.name;   fileName = fileName.slice(0, -3);   fileName = originalFolder + "/output/" + fileName + "_all_strings.jsn";   var writeFile = File( fileName );   out = writeFile.open('w', undefined, undefined);   writeFile.encoding = "UTF-8";   writeFile.lineFeed = "Macintosh";   writeFile.writeln( JSON.stringify( stringsArray ) );   writeFile.close();   activeDocument.close();} // if there are documents