// This script should be run by Adobe Illustrator on a design file.//// This script extracts all strings places them in a data file:// /output/<original name>_all_strings.jsn, intended to be used by// unit tests verifying that tags have been correctly replaced.#include "~/design_customization/app/assets/javascripts/json2.jsx"var stringsArray = [];if(documents.length > 0){  var originalDoc = activeDocument;  // Use this doc to convert cmyk to rgb  var newDoc = app.documents.add( DocumentColorSpace.RGB );  var textRefs = originalDoc.textFrames;  var originalFolder = originalDoc.fullName.path;  if(textRefs.length > 0)  {    for (var i = 0 ; i < textRefs.length; i++)    {        var fillColor;        var textLines = textRefs[i].lines;        var range = textRefs[i].textRange;        var attr = range.characterAttributes;        try        {          fillColor = attr.fillColor;          var c = fillColor.cyan;          var m = fillColor.magenta;          var y = fillColor.yellow;          var k = fillColor.black;          // translate the cmyk color to rgb          newDoc.defaultStrokeColor = fillColor;          var transColor = newDoc.defaultStrokeColor;          var r = transColor.red;          var g = transColor.green;          var b = transColor.blue;        }        catch( e )        {        }        if( textLines.length > 0 )        {            for( var x = 0; x < textLines.length; x++ )            {                var l = textLines[ x ];                var s = l.contents;                var o = {};                o.string = s;                o.c = c;                o.m = m;                o.y = y;                o.k = k;                o.r = r;                o.g = g;                o.b = b;                stringsArray.push( o );             } // each line        } // if there are lines    } // each text frame  } // if there are frames   var fileName = originalDoc.name;   fileName = fileName.slice(0, -3);   fileName = originalFolder + "/output/" + fileName + "_all_strings.jsn";   var writeFile = File( fileName );   out = writeFile.open('w', undefined, undefined);   writeFile.encoding = "UTF-8";   writeFile.lineFeed = "Macintosh";   writeFile.writeln( JSON.stringify( stringsArray, null, 2 ) );   writeFile.close();   originalDoc.close();   newDoc.close( SaveOptions.DONOTSAVECHANGES );} // if there are documents